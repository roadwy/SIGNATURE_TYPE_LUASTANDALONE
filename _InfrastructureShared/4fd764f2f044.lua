if mp.GetParentProcInfo() ~= nil and (string.lower(mp.GetParentProcInfo().image_path):match("([^\\]+)$") == "services.exe" or string.lower(mp.GetParentProcInfo().image_path):match("([^\\]+)$") == "svchost.exe" or string.lower(mp.GetParentProcInfo().image_path):match("([^\\]+)$") == "rundll32.exe" or string.lower(mp.GetParentProcInfo().image_path):match("([^\\]+)$") == "mstsc.exe" or string.lower(mp.GetParentProcInfo().image_path):match("([^\\]+)$") == "dllhost.exe" or string.lower(mp.GetParentProcInfo().image_path):match("([^\\]+)$") == "wuauclt.exe" or string.lower(mp.GetParentProcInfo().image_path):match("([^\\]+)$") == "msfeedssync.exe" or string.lower(mp.GetParentProcInfo().image_path):match("([^\\]+)$") == "nslookup.exe" or string.lower(mp.GetParentProcInfo().image_path):match("([^\\]+)$") == "werfault.exe" or string.lower(mp.GetParentProcInfo().image_path):match("([^\\]+)$") == "eventvwr.exe") then
  return mp.INFECTED
end
return mp.CLEAN
