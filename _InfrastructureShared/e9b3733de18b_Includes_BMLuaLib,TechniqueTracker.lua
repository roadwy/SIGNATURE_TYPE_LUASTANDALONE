if mp.IsHipsRuleEnabled("c1db55ab-c21a-4637-bb3f-a12568109d35") and bm.get_current_process_startup_info() ~= nil and bm.get_current_process_startup_info().command_line ~= nil and (IsDetectionThresholdMet(bm.get_current_process_startup_info().ppid) or GetTacticsTableForPid(bm.get_current_process_startup_info().ppid).winrshost_childproc or GetTacticsTableForPid(bm.get_current_process_startup_info().ppid).wsmprovhost_childproc or GetTacticsTableForPid(bm.get_current_process_startup_info().ppid).wmi_childproc or GetTacticsTableForPid(bm.get_current_process_startup_info().ppid).remotedropexe_childproc or GetTacticsTableForPid(bm.get_current_process_startup_info().ppid).python_childproc or GetTacticsTableForPid(bm.get_current_process_startup_info().ppid).rundll32_childproc or GetTacticsTableForPid(bm.get_current_process_startup_info().ppid).wscript_childproc or GetTacticsTableForPid(bm.get_current_process_startup_info().ppid).cscript_childproc or GetTacticsTableForPid(bm.get_current_process_startup_info().ppid).mshta_childproc or GetTacticsTableForPid(bm.get_current_process_startup_info().ppid).webshell_childproc or GetTacticsTableForPid(bm.get_current_process_startup_info().ppid).exec_remotedroppedscript_a) then
  bm_AddRelatedFileFromCommandLine(bm.get_current_process_startup_info().command_line, nil, nil, 1)
  TrackPidAndTechniqueBM(bm.get_current_process_startup_info().ppid, "T1003", "tt_remediate")
  return mp.INFECTED
end
return mp.CLEAN
