local L0_0, L1_1, L2_2, L3_3, L4_4, L5_5, L6_6, L7_7, L8_8, L9_9, L10_10
L0_0 = mp
L0_0 = L0_0.bitand
L1_1 = mp
L1_1 = L1_1.readu_u16
L2_2 = headerpage
L3_3 = 21
L1_1 = L1_1(L2_2, L3_3)
L2_2 = 1
L0_0 = L0_0(L1_1, L2_2)
if L0_0 ~= 1 then
  L0_0 = mp
  L0_0 = L0_0.CLEAN
  return L0_0
end
L0_0 = string
L0_0 = L0_0.lower
L1_1 = string
L1_1 = L1_1.sub
L2_2 = mp
L2_2 = L2_2.getfilename
L2_2 = L2_2()
L3_3 = -4
L10_10 = L1_1(L2_2, L3_3)
L0_0 = L0_0(L1_1, L2_2, L3_3, L4_4, L5_5, L6_6, L7_7, L8_8, L9_9, L10_10, L1_1(L2_2, L3_3))
if L0_0 ~= ".lnk" then
  L1_1 = mp
  L1_1 = L1_1.CLEAN
  return L1_1
end
L1_1 = mp
L1_1 = L1_1.getfilesize
L1_1 = L1_1()
if L1_1 > 1000 then
  L2_2 = mp
  L2_2 = L2_2.CLEAN
  return L2_2
end
if L1_1 < 50 then
  L2_2 = mp
  L2_2 = L2_2.CLEAN
  return L2_2
end
L2_2 = tostring
L3_3 = headerpage
L2_2 = L2_2(L3_3)
L3_3 = string
L3_3 = L3_3.find
L4_4 = L2_2
L5_5 = "\005\000\000\160"
L6_6 = L1_1 - 50
L7_7 = true
L3_3 = L3_3(L4_4, L5_5, L6_6, L7_7)
if L3_3 ~= nil then
  L4_4 = headerpage
  L5_5 = L3_3 + 4
  L4_4 = L4_4[L5_5]
  L5_5 = {}
  L5_5[2] = true
  L5_5[5] = true
  L5_5[6] = true
  L5_5[7] = true
  L5_5[8] = true
  L5_5[9] = true
  L5_5[11] = true
  L5_5[13] = true
  L5_5[16] = true
  L5_5[19] = true
  L5_5[20] = true
  L5_5[21] = true
  L5_5[22] = true
  L5_5[23] = true
  L5_5[24] = true
  L5_5[25] = true
  L5_5[26] = true
  L5_5[27] = true
  L5_5[28] = true
  L5_5[31] = true
  L5_5[32] = true
  L5_5[33] = true
  L5_5[34] = true
  L5_5[35] = true
  L5_5[36] = true
  L5_5[37] = true
  L5_5[38] = true
  L5_5[39] = true
  L5_5[40] = true
  L5_5[43] = true
  L5_5[45] = true
  L5_5[46] = true
  L5_5[47] = true
  L5_5[53] = true
  L5_5[54] = true
  L5_5[55] = true
  L5_5[59] = true
  L6_6 = L5_5[L4_4]
  if L6_6 then
    L6_6 = mp
    L6_6 = L6_6.set_mpattribute
    L7_7 = "LUA:Elenkay.SFID_Known"
    L6_6(L7_7)
    L6_6 = mp
    L6_6 = L6_6.CLEAN
    return L6_6
  end
  L6_6 = mp
  L6_6 = L6_6.set_mpattribute
  L7_7 = "LUA:Elenkay.SFID_Unkown"
  L6_6(L7_7)
  L6_6 = 79
  L7_7 = headerpage
  L8_8 = L3_3 + 8
  L7_7 = L7_7[L8_8]
  L8_8 = L6_6 + L7_7
  if L1_1 < L8_8 then
    L8_8 = mp
    L8_8 = L8_8.CLEAN
    return L8_8
  end
  L8_8 = mp
  L8_8 = L8_8.readu_u16
  L9_9 = headerpage
  L10_10 = L6_6 + L7_7
  L8_8 = L8_8(L9_9, L10_10)
  if L8_8 > 1024 then
    L9_9 = mp
    L9_9 = L9_9.CLEAN
    return L9_9
  end
  if L1_1 < L8_8 then
    L9_9 = mp
    L9_9 = L9_9.CLEAN
    return L9_9
  end
  L9_9 = string
  L9_9 = L9_9.sub
  L10_10 = L2_2
  L9_9 = L9_9(L10_10, L7_7 + L6_6, L8_8)
  L10_10 = string
  L10_10 = L10_10.gsub
  L10_10 = L10_10(L9_9, "%z", "")
  L9_9 = L10_10
  L10_10 = string
  L10_10 = L10_10.match
  L10_10 = L10_10(L9_9, "[[a-zA-Z]:]?[\\a-zA-Z0-9_.%-]+")
  if L10_10 ~= nil and sysio.GetFileAttributes(L10_10) ~= 4294967295 then
    return mp.INFECTED
  end
end
L4_4 = mp
L4_4 = L4_4.CLEAN
return L4_4
