local L0_0, L1_1, L2_2, L3_3, L4_4, L5_5, L6_6, L7_7, L8_8, L9_9, L10_10
L4_4 = this_sigattrlog
L4_4 = L4_4[2]
L4_4 = L4_4.matched
if L4_4 then
  L4_4 = string
  L4_4 = L4_4.lower
  L5_5 = this_sigattrlog
  L5_5 = L5_5[2]
  L5_5 = L5_5.utf8p2
  L4_4 = L4_4(L5_5)
  L0_0 = L4_4
  L4_4 = string
  L4_4 = L4_4.lower
  L5_5 = this_sigattrlog
  L5_5 = L5_5[2]
  L5_5 = L5_5.utf8p1
  L4_4 = L4_4(L5_5)
  L2_2 = L4_4
  L4_4 = string
  L4_4 = L4_4.match
  L5_5 = L2_2
  L6_6 = "\\([^\\]+)$"
  L4_4 = L4_4(L5_5, L6_6)
  L1_1 = L4_4
  L4_4 = this_sigattrlog
  L4_4 = L4_4[2]
  L3_3 = L4_4.ppid
else
  L4_4 = this_sigattrlog
  L4_4 = L4_4[3]
  L4_4 = L4_4.matched
  if L4_4 then
    L4_4 = string
    L4_4 = L4_4.lower
    L5_5 = this_sigattrlog
    L5_5 = L5_5[3]
    L5_5 = L5_5.utf8p2
    L4_4 = L4_4(L5_5)
    L0_0 = L4_4
    L4_4 = string
    L4_4 = L4_4.lower
    L5_5 = this_sigattrlog
    L5_5 = L5_5[3]
    L5_5 = L5_5.utf8p1
    L4_4 = L4_4(L5_5)
    L2_2 = L4_4
    L4_4 = string
    L4_4 = L4_4.match
    L5_5 = L2_2
    L6_6 = "\\([^\\]+)$"
    L4_4 = L4_4(L5_5, L6_6)
    L1_1 = L4_4
    L4_4 = this_sigattrlog
    L4_4 = L4_4[3]
    L3_3 = L4_4.ppid
  else
    L4_4 = this_sigattrlog
    L4_4 = L4_4[4]
    L4_4 = L4_4.matched
    if L4_4 then
      L4_4 = string
      L4_4 = L4_4.lower
      L5_5 = this_sigattrlog
      L5_5 = L5_5[4]
      L5_5 = L5_5.utf8p2
      L4_4 = L4_4(L5_5)
      L0_0 = L4_4
      L4_4 = string
      L4_4 = L4_4.lower
      L5_5 = this_sigattrlog
      L5_5 = L5_5[4]
      L5_5 = L5_5.utf8p1
      L4_4 = L4_4(L5_5)
      L2_2 = L4_4
      L4_4 = string
      L4_4 = L4_4.match
      L5_5 = L2_2
      L6_6 = "\\([^\\]+)$"
      L4_4 = L4_4(L5_5, L6_6)
      L1_1 = L4_4
      L4_4 = this_sigattrlog
      L4_4 = L4_4[4]
      L3_3 = L4_4.ppid
    else
      L4_4 = this_sigattrlog
      L4_4 = L4_4[5]
      L4_4 = L4_4.matched
      if L4_4 then
        L4_4 = string
        L4_4 = L4_4.lower
        L5_5 = this_sigattrlog
        L5_5 = L5_5[5]
        L5_5 = L5_5.utf8p2
        L4_4 = L4_4(L5_5)
        L0_0 = L4_4
        L4_4 = string
        L4_4 = L4_4.lower
        L5_5 = this_sigattrlog
        L5_5 = L5_5[5]
        L5_5 = L5_5.utf8p1
        L4_4 = L4_4(L5_5)
        L2_2 = L4_4
        L4_4 = string
        L4_4 = L4_4.match
        L5_5 = L2_2
        L6_6 = "\\([^\\]+)$"
        L4_4 = L4_4(L5_5, L6_6)
        L1_1 = L4_4
        L4_4 = this_sigattrlog
        L4_4 = L4_4[5]
        L3_3 = L4_4.ppid
      else
        L4_4 = this_sigattrlog
        L4_4 = L4_4[6]
        L4_4 = L4_4.matched
        if L4_4 then
          L4_4 = string
          L4_4 = L4_4.lower
          L5_5 = this_sigattrlog
          L5_5 = L5_5[6]
          L5_5 = L5_5.utf8p2
          L4_4 = L4_4(L5_5)
          L0_0 = L4_4
          L4_4 = string
          L4_4 = L4_4.lower
          L5_5 = this_sigattrlog
          L5_5 = L5_5[6]
          L5_5 = L5_5.utf8p1
          L4_4 = L4_4(L5_5)
          L2_2 = L4_4
          L4_4 = string
          L4_4 = L4_4.match
          L5_5 = L2_2
          L6_6 = "\\([^\\]+)$"
          L4_4 = L4_4(L5_5, L6_6)
          L1_1 = L4_4
          L4_4 = this_sigattrlog
          L4_4 = L4_4[6]
          L3_3 = L4_4.ppid
        else
          L4_4 = this_sigattrlog
          L4_4 = L4_4[7]
          L4_4 = L4_4.matched
          if L4_4 then
            L4_4 = string
            L4_4 = L4_4.lower
            L5_5 = this_sigattrlog
            L5_5 = L5_5[7]
            L5_5 = L5_5.utf8p2
            L4_4 = L4_4(L5_5)
            L0_0 = L4_4
            L4_4 = string
            L4_4 = L4_4.lower
            L5_5 = this_sigattrlog
            L5_5 = L5_5[7]
            L5_5 = L5_5.utf8p1
            L4_4 = L4_4(L5_5)
            L2_2 = L4_4
            L4_4 = string
            L4_4 = L4_4.match
            L5_5 = L2_2
            L6_6 = "\\([^\\]+)$"
            L4_4 = L4_4(L5_5, L6_6)
            L1_1 = L4_4
            L4_4 = this_sigattrlog
            L4_4 = L4_4[7]
            L3_3 = L4_4.ppid
          else
            L4_4 = mp
            L4_4 = L4_4.CLEAN
            return L4_4
          end
        end
      end
    end
  end
end
if L2_2 == nil or L1_1 == nil or L3_3 == nil then
  L4_4 = mp
  L4_4 = L4_4.CLEAN
  return L4_4
end
L4_4 = {}
L5_5 = "T1197"
if L0_0 ~= nil then
  L6_6 = string
  L6_6 = L6_6.find
  L7_7 = L0_0
  L8_8 = ".csv"
  L9_9 = 1
  L10_10 = true
  L6_6 = L6_6(L7_7, L8_8, L9_9, L10_10)
  if not L6_6 then
    L6_6 = string
    L6_6 = L6_6.find
    L7_7 = L0_0
    L8_8 = ".ora"
    L9_9 = 1
    L10_10 = true
    L6_6 = L6_6(L7_7, L8_8, L9_9, L10_10)
  elseif L6_6 then
    L6_6 = mp
    L6_6 = L6_6.CLEAN
    return L6_6
  end
  L6_6 = nil
  L7_7 = string
  L7_7 = L7_7.sub
  L8_8 = L0_0
  L9_9 = -1
  L7_7 = L7_7(L8_8, L9_9)
  if L7_7 == "\"" then
    L7_7 = string
    L7_7 = L7_7.lower
    L8_8 = mp
    L8_8 = L8_8.ContextualExpandEnvironmentVariables
    L9_9 = string
    L9_9 = L9_9.match
    L10_10 = L0_0
    L10_10 = L9_9(L10_10, " (\"[^\"]+\")[%s]*$")
    L10_10 = L8_8(L9_9, L10_10, L9_9(L10_10, " (\"[^\"]+\")[%s]*$"))
    L7_7 = L7_7(L8_8, L9_9, L10_10, L8_8(L9_9, L10_10, L9_9(L10_10, " (\"[^\"]+\")[%s]*$")))
    L6_6 = L7_7
    L7_7 = string
    L7_7 = L7_7.match
    L8_8 = L6_6
    L9_9 = "[^\"].*[^\"]"
    L7_7 = L7_7(L8_8, L9_9)
    L6_6 = L7_7
  else
    L7_7 = string
    L7_7 = L7_7.lower
    L8_8 = mp
    L8_8 = L8_8.ContextualExpandEnvironmentVariables
    L9_9 = string
    L9_9 = L9_9.match
    L10_10 = L0_0
    L10_10 = L9_9(L10_10, " (%S+)[%s]*$")
    L10_10 = L8_8(L9_9, L10_10, L9_9(L10_10, " (%S+)[%s]*$"))
    L7_7 = L7_7(L8_8, L9_9, L10_10, L8_8(L9_9, L10_10, L9_9(L10_10, " (%S+)[%s]*$")))
    L6_6 = L7_7
  end
  if L6_6 == nil then
    L7_7 = mp
    L7_7 = L7_7.CLEAN
    return L7_7
  end
  L7_7 = string
  L7_7 = L7_7.match
  L8_8 = L6_6
  L9_9 = "\\([^\\]+)$"
  L7_7 = L7_7(L8_8, L9_9)
  if L7_7 == nil then
    L8_8 = mp
    L8_8 = L8_8.CLEAN
    return L8_8
  end
  L8_8 = 600
  L9_9 = MpCommon
  L9_9 = L9_9.QueryPersistContext
  L10_10 = L6_6
  L9_9 = L9_9(L10_10, "BitsadminTarget")
  if not L9_9 then
    L9_9 = MpCommon
    L9_9 = L9_9.AppendPersistContext
    L10_10 = L6_6
    L9_9(L10_10, "BitsadminTarget", L8_8)
  end
  L9_9 = "BM_M"
  L10_10 = L5_5
  L9_9 = L9_9 .. L10_10
  L10_10 = table
  L10_10 = L10_10.insert
  L10_10(L4_4, L9_9)
  L10_10 = table
  L10_10 = L10_10.insert
  L10_10(L4_4, L9_9 .. ":sourcefilename_" .. L1_1)
  L10_10 = table
  L10_10 = L10_10.insert
  L10_10(L4_4, L9_9 .. ":sourceppid_" .. L3_3)
  L10_10 = table
  L10_10 = L10_10.insert
  L10_10(L4_4, L9_9 .. ":bits_target_" .. L7_7)
  L10_10 = table
  L10_10 = L10_10.insert
  L10_10(L4_4, L9_9 .. ":BitsTargetFile")
  L10_10 = false
  L10_10 = TrackFileAndTechnique(L6_6, L4_4, 0, "BitsadminTargetForExec")
  if L10_10 == false then
    return mp.CLEAN
  end
  return mp.INFECTED
end
L6_6 = mp
L6_6 = L6_6.CLEAN
return L6_6
