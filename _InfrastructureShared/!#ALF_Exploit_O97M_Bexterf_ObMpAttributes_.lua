local L0_0, L1_1, L2_2, L3_3, L4_4, L5_5
L0_0 = string
L0_0 = L0_0.lower
L1_1 = mp
L1_1 = L1_1.getfilename
L5_5 = L1_1()
L0_0 = L0_0(L1_1, L2_2, L3_3, L4_4, L5_5, L1_1())
if L0_0 ~= "" then
  L1_1 = string
  L1_1 = L1_1.find
  L5_5 = true
  L1_1 = L1_1(L2_2, L3_3, L4_4, L5_5)
  if L1_1 then
    L1_1 = mp
    L1_1 = L1_1.get_mpattribute
    L1_1 = L1_1(L2_2)
    if L1_1 then
      L1_1 = mp
      L1_1 = L1_1.GetNormalizedScript
      L1_1 = L1_1(L2_2)
      for L5_5 in L2_2(L3_3, L4_4), nil, nil do
        L5_5 = string.lower(L5_5)
        if L5_5:len() > 10 and not string.find(L5_5, "http://schemas.openxmlformats.org", 1, true) then
          if not string.find(L5_5, "/", 1, true) and not string.find(L5_5, "\\", 1, true) then
            return mp.CLEAN
          elseif string.find(L5_5, "kingsoft", 1, true) then
            return mp.CLEAN
          elseif string.find(L5_5, "file:///", 1, true) then
            mp.set_mpattribute("Lua:OfficeLocalFileReference")
          else
            mp.set_mpattribute("Lua:OfficeExternalReference")
            return mp.INFECTED
          end
        end
      end
    end
  end
end
L1_1 = mp
L1_1 = L1_1.CLEAN
return L1_1
