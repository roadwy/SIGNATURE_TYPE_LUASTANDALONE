local L0_0, L1_1, L2_2, L3_3
L0_0 = string
L0_0 = L0_0.lower
L1_1 = mp
L1_1 = L1_1.getfilename
L3_3 = L1_1()
L0_0 = L0_0(L1_1, L2_2, L3_3, L1_1())
L1_1 = string
L1_1 = L1_1.find
L2_2 = L0_0
L3_3 = "c:\\c:c:"
L1_1 = L1_1(L2_2, L3_3, 1, true)
if not L1_1 then
  L1_1 = string
  L1_1 = L1_1.find
  L2_2 = L0_0
  L3_3 = "d:\\c:c:"
  L1_1 = L1_1(L2_2, L3_3, 1, true)
  if not L1_1 then
    L1_1 = string
    L1_1 = L1_1.find
    L2_2 = L0_0
    L3_3 = "c:\\\\\\%d%d?%d?%.%d%d?%d?%.%d%d?%d?%.%d%d?%d?\\"
    L1_1 = L1_1(L2_2, L3_3)
  end
elseif L1_1 then
  L1_1 = string
  L1_1 = L1_1.sub
  L2_2 = L0_0
  L3_3 = -3
  L1_1 = L1_1(L2_2, L3_3)
  if L1_1 == "exe" or L1_1 == "pif" or L1_1 == "scr" or L1_1 == "dll" or L1_1 == "jse" or L1_1 == "vbs" or L1_1 == "vbe" or L1_1 == "lnk" or L1_1 == ".js" or L1_1 == "bat" or L1_1 == "doc" or L1_1 == "ocx" then
    L2_2 = mp
    L2_2 = L2_2.get_parent_filehandle
    L2_2 = L2_2()
    L3_3 = mp
    L3_3 = L3_3.is_handle_nil
    L3_3 = L3_3(L2_2)
    if not L3_3 then
      L3_3 = mp
      L3_3 = L3_3.readprotection
      L3_3(false)
      L3_3 = mp
      L3_3 = L3_3.readfile_by_handle
      L3_3 = L3_3(L2_2, 7, 7)
      if L3_3 ~= nil and string.find(L3_3, "**ACE**", 1, true) then
        return mp.INFECTED
      end
    end
  end
end
L1_1 = mp
L1_1 = L1_1.CLEAN
return L1_1
